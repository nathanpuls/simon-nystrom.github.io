{"pageProps":{"post":{"html":"<p>Turning <code>Markdown</code> into <code>HTML</code> is a very useful task. <code>Markdown</code> lends itself to simpler syntax requiring less nesting and lends itself to more readable documentation and reading in general. This tutorial will go through the steps required to read Markdown files and turn them into <code>HTML</code> that you can then use on your blog, like I do on <a href=\"https://newcurrent.se\">my site</a>, or for any other purpose where you want easier editing potential. This tutorial will use these concepts on a Next.js blog, but those parts don&#39;t need to be followed to understand how this works.</p>\n<p>Although this post is part of a series, the aim is for the post to be able to stand relatively well on its own, you should be able to take away some knowledge even if you&#39;re not following the tutorial series. If you&#39;re interested, the tutorial series starts here: <a href=\"https://newcurrent.se/blog/initialize-nextjs-project\">Part 1</a>.</p>\n<hr>\n<h1 id=\"prerequisites\">Prerequisites</h1>\n<p>The prerequisites for this tutorial are stated in <a href=\"https://newcurrent.se/blog/initialize-nextjs-project\">Part 1</a> and the components we will be using in this tutorial are from the previous parts of this series: <a href=\"https://newcurrent.se/blog/initialize-nextjs-project\">1</a> <a href=\"https://newcurrent.se/blog/nextjs-routing\">2</a> and <a href=\"https://newcurrent.se/blog/nextjs-styled-components\">3</a>.</p>\n<hr>\n<h1 id=\"utilizing-front-matter\">Utilizing Front Matter</h1>\n<p>It&#39;s useful to be able to connect metadata to <code>Markdown</code> documents that you write, this is commonly done with something called front matter (sometimes YAML Front Matter). An example of this is shown below:</p>\n<pre><div class=\"copy-me\" onclick=\"copyCode(this)\">Copy</div><code><span class=\"hljs-meta\">---</span>\n<span class=\"hljs-attr\">date:</span> <span class=\"hljs-string\">&quot;2020-11-15 09:31&quot;</span>\n<span class=\"hljs-attr\">title:</span> <span class=\"hljs-string\">&quot;My first blog post!&quot;</span>\n<span class=\"hljs-attr\">slug:</span> <span class=\"hljs-string\">&quot;my-first-blog-post&quot;</span>\n<span class=\"hljs-meta\">---</span></code></pre><p>First, we need some libraries to help us make this task way easier, install two new dependencies:</p>\n<pre><div class=\"copy-me\" onclick=\"copyCode(this)\">Copy</div><code>yarn add -D marked front-matter</code></pre><ul>\n<li><a href=\"https://marked.js.org/\"><code>marked</code></a> will be used to turn <code>Markdown</code> into <code>HTML</code></li>\n<li><a href=\"https://www.npmjs.com/package/front-matter\"><code>front-matter</code></a> will be used to extract the metadata from the <code>Front Matter</code> of our <code>Markdown</code> documents</li>\n</ul>\n<p>Our first task will be to enable the use of <code>Front Matter</code> in our <code>Markdown</code> documents.</p>\n<p>Start by creating a folder in the root of your project, call it <code>posts</code> and in that directory create a file <code>posts/my_first_post.md</code>:</p>\n<pre><div class=\"copy-me\" onclick=\"copyCode(this)\">Copy</div><code>---\ndate: &quot;2020-11-15 09:31&quot;\ntitle: &quot;My first blog post!&quot;\n<span class=\"hljs-section\">slug: &quot;my-first-blog-post&quot;\n---</span>\n\nWelcome to my first blog post :)\n\n<span class=\"hljs-code\">```javascript\n// Look, we have highlighting!\n\nconst a = 5;\nconst b = &quot;Testing&quot;;\n\nfunction yay() {\n    console.log(&quot;Yay!&quot;);\n}\n```</span></code></pre><p>Now that the base of our first <code>Markdown</code> file has been created, let&#39;s write some code to read posts from this folder and generate objects with this metadata and <code>HTML</code> so that we can use it on a page:</p>\n<p>If you&#39;ve been following along, go to the <code>pages/_posts.js</code>, otherwise create a new file that will hold the code for reading the <code>posts</code> directory:</p>\n<pre><div class=\"copy-me\" onclick=\"copyCode(this)\">Copy</div><code><span class=\"hljs-comment\">// pages/_posts.js</span>\n\n<span class=\"hljs-keyword\">const</span> fs = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&quot;fs&quot;</span>);\n<span class=\"hljs-keyword\">const</span> marked = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&quot;marked&quot;</span>);\n<span class=\"hljs-keyword\">const</span> fm = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&quot;front-matter&quot;</span>);\n\n<span class=\"hljs-keyword\">const</span> postFiles = fs.readdirSync(<span class=\"hljs-string\">&quot;posts&quot;</span>);\n<span class=\"hljs-keyword\">const</span> posts = [];\n<span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">let</span> i = <span class=\"hljs-number\">0</span>; i &lt; postFiles.length; i++) {\n    <span class=\"hljs-keyword\">const</span> postContent = fs.readFileSync(<span class=\"hljs-string\">`posts/<span class=\"hljs-subst\">${postFiles[i]}</span>`</span>, {\n        <span class=\"hljs-attr\">encoding</span>: <span class=\"hljs-string\">&quot;utf-8&quot;</span>,\n    });\n    <span class=\"hljs-keyword\">const</span> { body, ...frontMatter } = fm(postContent);\n    posts.push({\n        <span class=\"hljs-attr\">html</span>: marked(body),\n        ...frontMatter,\n    });\n}\n\n<span class=\"hljs-comment\">// posts will now be an array of objects with the following structure:</span>\n<span class=\"hljs-comment\">/*\nposts = [\n    {\n        attributes: { date, title, slug } &lt;- from our front matter,\n        html: &quot;A string with our HTML content&quot;\n    }\n]\n*/</span>\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> posts;</code></pre><p>Since we&#39;re exposing a new structure from <code>pages/_posts.js</code> we also need to change how the <code>BlogPage</code> component defined in <code>pages/blog/index.js</code> renders these files, only the Component part has changed, the rest remains the same. This is what it looks like now:</p>\n<pre><div class=\"copy-me\" onclick=\"copyCode(this)\">Copy</div><code><span class=\"hljs-comment\">// part of `pages/blog/index.js`</span>\n<span class=\"hljs-keyword\">const</span> BlogPage = <span class=\"hljs-function\">(<span class=\"hljs-params\">{ posts }</span>) =&gt;</span> {\n  <span class=\"hljs-keyword\">return</span> (\n    <span class=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">Main</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">Ul</span>&gt;</span>\n        {posts.map((post) =&gt; (\n          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">Li</span> <span class=\"hljs-attr\">key</span>=<span class=\"hljs-string\">{post.attributes.slug}</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">Link</span> <span class=\"hljs-attr\">href</span>=<span class=\"hljs-string\">{</span>`<span class=\"hljs-attr\">blog</span>/${<span class=\"hljs-attr\">post.attributes.slug</span>}`}&gt;</span>\n              <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">a</span>&gt;</span>\n                <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">BlogLink</span>&gt;</span>\n                  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">h3</span>&gt;</span>{post.attributes.title}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">h3</span>&gt;</span>\n                  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">h5</span>&gt;</span>{post.attributes.date}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">h5</span>&gt;</span>\n                <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">BlogLink</span>&gt;</span>\n              <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">a</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">Link</span>&gt;</span>\n          <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">Li</span>&gt;</span>\n        ))}\n      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">Ul</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">Main</span>&gt;</span></span>\n  )\n}</code></pre><p>Notice that we&#39;re accessing <code>Front Matter</code> properties here on the <code>.attributes</code> object.</p>\n<p>Our <code>pages/blog/[slug].js</code> also needs to be updated since it was also reading posts the old way. All the references to <code>title</code>, <code>slug</code> and <code>date</code> are now from a nested object. Here&#39;s that file updated:</p>\n<pre><div class=\"copy-me\" onclick=\"copyCode(this)\">Copy</div><code><span class=\"hljs-comment\">// `pages/blog/[slug].js`</span>\n<span class=\"hljs-keyword\">import</span> styled <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;styled-components&quot;</span>\n<span class=\"hljs-keyword\">import</span> posts <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;../_posts&quot;</span>\n\n<span class=\"hljs-keyword\">const</span> Article = styled.article<span class=\"hljs-string\">`\n  max-width: 56em;\n  padding: 0.8em;\n  margin: 0 auto;\n`</span>\n\n<span class=\"hljs-keyword\">const</span> BlogPost = <span class=\"hljs-function\">(<span class=\"hljs-params\">{ post }</span>) =&gt;</span> (\n  <span class=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">Article</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">h1</span>&gt;</span>{post.attributes.title}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">h1</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">p</span>&gt;</span>{post.attributes.date}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">p</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">Article</span>&gt;</span></span>\n)\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> BlogPost\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">async</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">getStaticPaths</span>(<span class=\"hljs-params\"></span>) </span>{\n  <span class=\"hljs-keyword\">return</span> {\n    <span class=\"hljs-attr\">paths</span>: posts.map(<span class=\"hljs-function\">(<span class=\"hljs-params\">post</span>) =&gt;</span> ({ <span class=\"hljs-attr\">params</span>: { <span class=\"hljs-attr\">slug</span>: post.attributes.slug } })),\n    <span class=\"hljs-attr\">fallback</span>: <span class=\"hljs-literal\">false</span>,\n  }\n}\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">async</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">getStaticProps</span>(<span class=\"hljs-params\">{ params }</span>) </span>{\n  <span class=\"hljs-keyword\">return</span> {\n    <span class=\"hljs-attr\">props</span>: {\n      <span class=\"hljs-attr\">post</span>: posts.find(<span class=\"hljs-function\">(<span class=\"hljs-params\">post</span>) =&gt;</span> post.attributes.slug === params.slug),\n    },\n  }\n}\n</code></pre><p>You should be able to use your page as you did in the previous step now, but the information is now dynamic and comes from <code>Markdown</code> files located in the <code>posts</code> directory! Try and add another post for example, it should show up next to our first blog post. Note however, that when you change a file in the <code>posts</code> directory the dev server (<code>yarn dev</code>) has to be restarted since these are only read and parsed once (when the pages are being generated by <code>Next.js</code>).</p>\n<hr>\n<h1 id=\"displaying-the-html-content\">Displaying the HTML content</h1>\n<p>So far, our posts only show the data from the <code>Front Matter</code> of the <code>Markdown</code> documents, let&#39;s also make them display the <code>HTML</code> content. Doing this in <code>React</code> is easy but it sounds, well, dangerous:</p>\n<pre><div class=\"copy-me\" onclick=\"copyCode(this)\">Copy</div><code><span class=\"hljs-comment\">// part of pages/blog/[slug].js</span>\n<span class=\"hljs-keyword\">const</span> BlogPost = <span class=\"hljs-function\">(<span class=\"hljs-params\">{ post }</span>) =&gt;</span> (\n  <span class=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">Article</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">h1</span>&gt;</span>{post.attributes.title}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">h1</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">p</span>&gt;</span>{post.attributes.date}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">p</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">className</span>=<span class=\"hljs-string\">&quot;blog-post-content&quot;</span> <span class=\"hljs-attr\">dangerouslySetInnerHTML</span>=<span class=\"hljs-string\">{{</span> <span class=\"hljs-attr\">__html:</span> <span class=\"hljs-attr\">post.html</span> }}&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">Article</span>&gt;</span></span>\n)\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> BlogPost</code></pre><p>The <code>dangerouslySetInnerHTML</code> is accurately named. This is normally something that isn&#39;t a good thing to do, but when you have an HTML string that you want rendered as actual HTML, it&#39;s the way to go. You should never do this unless you have <em>full control</em> of the string that gets passed in here!</p>\n<p>The <code>className</code> here is specified as a simple <code>string</code>. That&#39;s so that we can style all of our blog post related things in the global stylesheet since these elements are created in the <code>dangerouslySetInnerHTML</code> part and can&#39;t be accessed at this point.</p>\n<p>Refresh one of the blog post pages now and you should see that the post content shows up.</p>\n<p>Now even the content of the post is dynamic and read from a file, go ahead and change the content below the front matter in the <code>posts/my_first_post.md</code> file and restart the server and you should see that the content on the page has changed too.</p>\n<p>You may have tried code blocks in <code>Markdown</code> and realized that it it doesn&#39;t have any syntax highlighting, read the next section if you want to know how to get that working.</p>\n<hr>\n<h1 id=\"adding-syntax-highlighting\">Adding syntax highlighting</h1>\n<p>Code blocks are nice. But they&#39;re even nicer if they actually contain syntax highlighting. For this we&#39;ll use a library called <a href=\"https://highlightjs.org/\"><code>highlight.js</code></a>:</p>\n<pre><div class=\"copy-me\" onclick=\"copyCode(this)\">Copy</div><code>yarn add -D highlight.js</code></pre><p>To make use of this library we have to take two steps, one is to include a theme stylesheet and the other is to have the <code>marked</code> library, that we installed earlier, use the <code>highlight.js</code> lib.</p>\n<p>Let&#39;s start by having <code>marked</code> use the <code>highlight.js</code> library in the <code>pages/_posts.js</code> file:</p>\n<pre><div class=\"copy-me\" onclick=\"copyCode(this)\">Copy</div><code><span class=\"hljs-comment\">// Add this below the require statements at the top of `pages/_posts.js` </span>\n<span class=\"hljs-keyword\">const</span> hljs = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&quot;highlight.js&quot;</span>)\n\nmarked.setOptions({\n    <span class=\"hljs-attr\">highlight</span>: <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">code, lang</span>) </span>{\n        <span class=\"hljs-keyword\">if</span> (lang) <span class=\"hljs-keyword\">return</span> hljs.highlight(lang, code).value;\n        <span class=\"hljs-keyword\">return</span> code\n    }\n});</code></pre><p>This makes it so that when <code>marked</code> runs across a code block, it&#39;ll run the <code>hljs.highlight</code> function and put classes for the relevant elements in the <code>HTML</code> string that gets generated by <code>marked</code>.</p>\n<p>Then, let&#39;s make sure to import a theme in our <code>BlogPost</code> component in the <code>pages/blog/[slug].js</code> file:</p>\n<pre><div class=\"copy-me\" onclick=\"copyCode(this)\">Copy</div><code><span class=\"hljs-keyword\">const</span> BlogPost = <span class=\"hljs-function\">(<span class=\"hljs-params\">{ post }</span>) =&gt;</span> (\n  <span class=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">Article</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">Head</span>&gt;</span><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">link</span>\n      <span class=\"hljs-attr\">rel</span>=<span class=\"hljs-string\">&quot;stylesheet&quot;</span>\n      <span class=\"hljs-attr\">href</span>=<span class=\"hljs-string\">&quot;//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/styles/atom-one-dark-reasonable.min.css&quot;</span>\n    /&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">Head</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">h1</span>&gt;</span>{post.attributes.title}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">h1</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">p</span>&gt;</span>{post.attributes.date}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">p</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">className</span>=<span class=\"hljs-string\">&quot;blog-post-content&quot;</span> <span class=\"hljs-attr\">dangerouslySetInnerHTML</span>=<span class=\"hljs-string\">{{</span> <span class=\"hljs-attr\">__html:</span> <span class=\"hljs-attr\">post.html</span> }}&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">Article</span>&gt;</span></span>\n)\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> BlogPost</code></pre><p>Make sure to put <code>import Head from &quot;next/head&quot;</code> at the top of the file too, to import the <code>Head</code> component from <code>Next.js</code>.</p>\n<p>More themes available here: <code>https://highlightjs.org/static/demo/</code>. Replace the <code>href</code> in the <code>link</code> element with the theme of your choice and it should work.</p>\n<hr>\n<h1 id=\"styling-our-generated-html\">Styling our generated HTML</h1>\n<p>In a previous post, we&#39;ve just styled components we created ourselves. Now since <code>marked</code> will be creating a bunch of components for us. Let&#39;s try to do some styling in our <code>styles/globals.css</code>.</p>\n<p>If you&#39;re completely caught up with the tutorial series at this point, your page looks something like this:</p>\n<p><img src=\"images/next/page.png\" alt=\"Page at this point\"></p>\n<p>It&#39;s not awful, but obviously the code block could really use a background, it doesn&#39;t stand out enough from the rest of the text in my opinion. Let&#39;s do that now.</p>\n<p>Earlier in this post, we defined a class on the content element called <code>blog-post-content</code>. This class is what we&#39;ll use to target the blog post elements. Inspect the element and you&#39;ll find that the code block is simply a <code>&lt;pre&gt;</code> tag with a <code>&lt;code&gt;</code> tag inside. </p>\n<p>Let&#39;s make our code block prettier, in <code>styles/globals.css</code>:</p>\n<pre><div class=\"copy-me\" onclick=\"copyCode(this)\">Copy</div><code><span class=\"hljs-comment\">/* at the bottom add */</span>\n<span class=\"hljs-selector-tag\">pre</span> {\n  <span class=\"hljs-attribute\">color</span>: white;\n  <span class=\"hljs-attribute\">background</span>: <span class=\"hljs-number\">#282c34</span>;\n  <span class=\"hljs-attribute\">padding</span>: <span class=\"hljs-number\">10px</span>;\n  <span class=\"hljs-attribute\">border-radius</span>: <span class=\"hljs-number\">6px</span>;\n}</code></pre><p>Refreshing the page should give you a nicer looking code block. You can repeat for other components created by <code>marked</code> too, of course. Just inspect the DOM and see what tags were rendered and style those in <code>styles/globals.css</code>.</p>\n<hr>\n<p>Now we have a styled <code>Next.js</code> app that supports dynamic routing based on dynamic data specified in markdown files set ready to go for the next part of this tutorial series.</p>\n<p>Here&#39;s what my project looks like at this stage: <a href=\"https://github.com/simon-nystrom/nextjs-blog-example/tree/p4\">https://github.com/simon-nystrom/nextjs-blog-example/tree/p4</a></p>\n<p>I hope you&#39;ll keep following along with the tutorial, please don&#39;t hesitate to ask if you have any questions or tell me if I missed something!</p>\n","date":"2020-11-15 21:40","title":"Turning Markdown into HTML","slug":"markdown-to-html","series_title":"Creating a blog with React and Next.js","part":4,"last_part":"?","summary":"Learn how to turn Markdown into HTML.","categories":[],"published":true,"tags":["react","javascript","nextjs","tutorial"]}},"__N_SSG":true}